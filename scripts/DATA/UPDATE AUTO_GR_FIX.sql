UPDATE FLT
SET FLT.START_CONTRACT = EXCL.F5
FROM MST_FLEET FLT
INNER JOIN OPENROWSET('Microsoft.ACE.OLEDB.12.0',
									'Excel 8.0;HDR=NO;Database=\\pmiidsubdev41\ssisfiles$\FMS\auto_gr_fix_2.xlsx',
									'select * from [Auto GR from FMS$]') EXCL
      ON FLT.PO_NUMBER = EXCL.F1
	  AND FLT.PO_LINE = EXCL.F2
	  AND FLT.POLICE_NUMBER = EXCL.F4
GO



insert INTO AUTO_GR ( CREATED_DATE,IS_POSTED,LINE_ITEM,PO_DATE,PO_NUMBER,QTY_ITEM)
SELECT '2017-09-04 04:00:00' AS CREATED_DATE,1 AS IS_POSTED, F2 AS LINE_ITEM,'2017-09-04 04:00:00' AS PO_DATE,F1 AS PO_NUMBER,  F16 - isnull((SELECT SUM(QTY_ITEM) FROM AUTO_GR gr
WHERE  F1 = gr.PO_NUMBER AND F2 = GR.LINE_ITEM),0) AS QTY_ITEM
FROM OPENROWSET(
    'Microsoft.ACE.OLEDB.12.0',
	'Excel 8.0;HDR=NO;Database=D:\FILEX.xlsx',
	'select * from [Auto GR from FMS$]')
WHERE F1 <> 'PO Number' AND F16 IS NOT NULL
GROUP BY F1,F2,F16
