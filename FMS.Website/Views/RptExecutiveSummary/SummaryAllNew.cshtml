@using FMS.Core;
@model FMS.Website.Models.SummaryAllModel

@{
    ViewBag.Title = Model.TitleForm;
}

<div class="opt-content clearfloat">
    <h5 class="title-page">@ViewBag.Title</h5>
    @if (Model.CurrentPageAccess.ReadAccess == true)
    {
        <a href="#!" class="btn btn-primary line" id="btnExport" title="Export To Excel" onclick="ExportXls()">
            <i class="fa fa-download"></i> Export
        </a>
    }
</div>
<script type="text/javascript">
    $(document).ready(function () {
        $('#SearchView_YearFrom').datepicker({
            minViewMode: 2,
            format: 'yyyy',
            autoclose: true,
            position: 'right bottom',
            container: '#xz'
        });
    });
</script>

<div class="well" style="margin:-1px;">
    <div class="wpanel" style="margin-left:22px;margin-right:22px;">
        <div class="row">
            <div class="col-md-3">
                <div class="form-group">
                    <label for="">Month</label>
                    @Html.DropDownListFor(model => model.SearchView.MonthFrom, Model.SearchView.MonthList, new { @class = "form-control month" })
                </div>
            </div>
            <div class="col-md-3">
                <div class="form-group" id="xz">
                    <label for="">Year</label>
                    <input type="text" id="SearchView_YearFrom" value="@Model.SearchView.YearFrom" class="form-control year" data-provide="datepicker" />
                </div>
            </div>
            <div class="clearfix"></div>
            <div class="col-md-12">
                <button id="btn-filter" type="submit" class="btn btn-primary">Filter</button>
                <button id="btn-reset" type="button" class="btn btn-default">Reset</button>
            </div>
        </div>
    </div>
    <div class="content chart-summary">
        <div class="row">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-body">
                        @*<h5 class="card-title"><i class="fa fa-bullseye"></i> Number Of Vehicle</h5>*@
                        <canvas id="lineChart"></canvas>
                    </div>
                    <div class="card-footer"><i class="fa fa-clock-o"></i> <b>Number Of Vehicle</b></div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card">
                    <div class="card-body">
                        @*<h5 class="card-title"><i class="fa fa-compress"></i> Vehicle By Regional</h5>*@
                        <canvas id="mybarChart"></canvas>
                    </div>
                    <div class="card-footer"><i class="fa fa-clock-o"></i> <b>Vehicle By Regional</b></div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card">
                    <div class="card-body">
                        @*<h5 class="card-title"><i class="fa fa-credit-card"></i> Vehicle By Make</h5>*@
                        <canvas id="canvasDoughnut"></canvas>
                    </div>
                    <div class="card-footer"><i class="fa fa-clock-o"></i> <b>Vehicle By Make</b></div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card">
                    <div class="card-body">
                        @*<h5 class="card-title"><i class="fa fa-balance-scale"></i> Vehicle By Type</h5>*@
                        <canvas id="polarArea"></canvas>
                    </div>
                    <div class="card-footer"><i class="fa fa-clock-o"></i> <b>Vehicle By Type</b></div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card">
                    <div class="card-body">
                        @*<h5 class="card-title"><i class="fa fa-credit-card"></i> Odometer</h5>*@
                        <canvas id="canvasRadar"></canvas>
                    </div>
                    <div class="card-footer"><i class="fa fa-clock-o"></i> <b>Odometer</b></div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card">
                    <div class="card-body">
                        @*<h5 class="card-title"><i class="fa fa-credit-card"></i> Liters</h5>*@
                        <canvas id="pieChart"></canvas>
                    </div>
                    <div class="card-footer"><i class="fa fa-clock-o"></i> <b>Liters</b></div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card">
                    <div class="card-body">
                        @*<h5 class="card-title"><i class="fa fa-car"></i> Fuel & Lease Cost</h5>*@
                        <canvas id="mybarChart2"></canvas>
                    </div>
                    <div class="card-footer"><i class="fa fa-clock-o"></i> <b>Fuel & Lease Cost</b></div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card">
                    <div class="card-body">
                        @*<h5 class="card-title"><i class="fa fa-car"></i> Sales By Region</h5>*@
                        <canvas id="lineChart2"></canvas>
                    </div>
                    <div class="card-footer"><i class="fa fa-clock-o"></i> <b>Sales By Region</b></div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card">
                    <div class="card-body">
                        @*<h5 class="card-title"><i class="fa fa-car"></i> Sales By Region</h5>*@
                        <canvas id="lineChart3"></canvas>
                    </div>
                    <div class="card-footer"><i class="fa fa-clock-o"></i> <b>AC vs OB</b></div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card">
                    <div class="card-body">
                        @*<h5 class="card-title"><i class="fa fa-car"></i> Fuel & Lease Cost</h5>*@
                        <canvas id="mybarChart3"></canvas>
                    </div>
                    <div class="card-footer"><i class="fa fa-clock-o"></i> <b>Accident</b></div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="LoadingModal" class="modal" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body">
                <div align="center">
                    <img src="~/Content/img/loader2.gif" id="imgLoader" style="display:block" />
                </div>
            </div>
        </div>
    </div>
</div>
<script src="~/Scripts/js/Chart.bundle.min.js"></script>
<script src="~/Scripts/jquery.unobtrusive-ajax.min.js"></script>
<script src="~/Scripts/execsumscript.js"></script>
<script type="text/javascript">
    function init_charts() {
        console.log('run_charts  typeof [' + typeof (Chart) + ']');

        if (typeof (Chart) === 'undefined') { return; }

        console.log('init_charts');


        //Chart.defaults.global.legend = {
        //    enabled: false
        //};

        // Line chart

        if ($('#lineChart').length) {

            var ctx = document.getElementById("lineChart");
            var lineChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ["Sales", "Marketing", "Operations", "HR", "GS", "Logistics", "Others"],
                    datasets: [{
                        label: "BENEFIT",
                        backgroundColor: "rgba(130, 130, 130, 0.31)",
                        borderColor: "rgba(130, 130, 130, 0.7)",
                        pointBorderColor: "rgba(130, 130, 130, 0.7)",
                        pointBackgroundColor: "rgba(130, 130, 130, 0.7)",
                        pointHoverBackgroundColor: "#fff",
                        pointHoverBorderColor: "rgba(130,130,130,1)",
                        pointBorderWidth: 1,
                        data: [31, 74, 6, 39, 20, 85, 7]
                    }, {
                        label: "WTC",
                        backgroundColor: "rgba(33, 164, 255, 0.3)",
                        borderColor: "rgba(33, 164, 255, 0.70)",
                        pointBorderColor: "rgba(33, 164, 255, 0.70)",
                        pointBackgroundColor: "rgba(33, 164, 255, 0.70)",
                        pointHoverBackgroundColor: "#fff",
                        pointHoverBorderColor: "rgba(33, 164, 255,1)",
                        pointBorderWidth: 1,
                        data: [82, 23, 66, 9, 99, 4, 2]
                    }]
                },
            });

        }

        // Line chart

        if ($('#lineChart2').length) {

            var ctx = document.getElementById("lineChart2");
            var lineChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ["Sumatra 1", "Sumatra 2", "Jakarta", "Java 1", "Java 2", "Bali Nusra", "Kalimantan"],
                    datasets: [{
                        label: "Operational Cost per Stick",
                        backgroundColor: "rgba(130, 130, 130, 0.31)",
                        borderColor: "rgba(130, 130, 130, 0.7)",
                        pointBorderColor: "rgba(130, 130, 130, 0.7)",
                        pointBackgroundColor: "rgba(130, 130, 130, 0.7)",
                        pointHoverBackgroundColor: "#fff",
                        pointHoverBorderColor: "rgba(130,130,130,1)",
                        pointBorderWidth: 1,
                        data: [31, 74, 6, 39, 20, 85, 7]
                    }, {
                        label: "Operational Cost per KM",
                        backgroundColor: "rgba(33, 164, 255, 0.3)",
                        borderColor: "rgba(33, 164, 255, 0.70)",
                        pointBorderColor: "rgba(33, 164, 255, 0.70)",
                        pointBackgroundColor: "rgba(33, 164, 255, 0.70)",
                        pointHoverBackgroundColor: "#fff",
                        pointHoverBorderColor: "rgba(33, 164, 255,1)",
                        pointBorderWidth: 1,
                        data: [82, 23, 66, 9, 99, 4, 2]
                    }]
                },
            });

        }

        // Line chart

        if ($('#lineChart3').length) {

            var ctx = document.getElementById("lineChart3");
            var lineChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ["Sales", "Marketing", "Operations", "Logistic", "HR", "GS", "Other"],
                    datasets: [{
                        label: "Actual Cost",
                        backgroundColor: "rgba(130, 130, 130, 0.31)",
                        borderColor: "rgba(130, 130, 130, 0.7)",
                        pointBorderColor: "rgba(130, 130, 130, 0.7)",
                        pointBackgroundColor: "rgba(130, 130, 130, 0.7)",
                        pointHoverBackgroundColor: "#fff",
                        pointHoverBorderColor: "rgba(130,130,130,1)",
                        pointBorderWidth: 1,
                        data: [31, 74, 6, 39, 20, 85, 7]
                    }, {
                        label: "Operational Budget",
                        backgroundColor: "rgba(33, 164, 255, 0.3)",
                        borderColor: "rgba(33, 164, 255, 0.70)",
                        pointBorderColor: "rgba(33, 164, 255, 0.70)",
                        pointBackgroundColor: "rgba(33, 164, 255, 0.70)",
                        pointHoverBackgroundColor: "#fff",
                        pointHoverBorderColor: "rgba(33, 164, 255,1)",
                        pointBorderWidth: 1,
                        data: [82, 23, 66, 9, 99, 4, 2]
                    }]
                },
            });

        }

        // Bar chart

        if ($('#mybarChart').length) {

            var ctx = document.getElementById("mybarChart");
            var mybarChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ["Sumatra 1", "Sumatra 2", "Jakarta", "Java 1", "Java 2", "Bali Nusra", "Kalimantan"],
                    datasets: [{
                        label: 'Sales',
                        backgroundColor: "#B21B1B",
                        data: [51, 30, 40, 28, 92, 50, 45]
                    }, {
                        label: 'Marketing',
                        backgroundColor: "#1FB21B",
                        data: [41, 56, 25, 48, 72, 34, 12]
                    }]
                },

                options: {
                    scales: {
                        yAxes: [{
                            ticks: {
                                beginAtZero: true
                            }
                        }]
                    }
                }
            });

        }

        // Bar chart

        if ($('#mybarChart2').length) {

            var ctx = document.getElementById("mybarChart2");
            var mybarChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ["Sales", "Marketing", "Operations", "Logistic", "HR", "GS", "Other"],
                    datasets: [{
                        label: 'Fuel cost',
                        backgroundColor: "#21A4FF",
                        data: [51, 30, 40, 28, 92, 50, 45]
                    }, {
                        label: 'Lease cost',
                        backgroundColor: "#FF8000",
                        data: [77, 15, 55, 44, 70, 30, 15]
                    }]
                },

                options: {
                    scales: {
                        yAxes: [{
                            ticks: {
                                beginAtZero: true
                            }
                        }]
                    }
                }
            });

        }

        // Bar chart

        if ($('#mybarChart3').length) {

            var ctx = document.getElementById("mybarChart3");
            var mybarChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ["Sales", "Marketing", "Operations", "Logistic", "HR", "GS", "Other"],
                    datasets: [{
                        label: 'All',
                        backgroundColor: "#00FF00",
                        data: [128, 45, 95, 72, 162, 80, 55]
                    }, {
                        label: 'BENEFIT',
                        backgroundColor: "#FFFF80",
                        data: [77, 15, 55, 44, 70, 30, 15]
                    }, {
                        label: 'WTC',
                        backgroundColor: "#FF8000",
                        data: [51, 30, 40, 28, 92, 50, 45]
                    }]
                },

                options: {
                    scales: {
                        yAxes: [{
                            ticks: {
                                beginAtZero: true
                            }
                        }]
                    }
                }
            });

        }


        // Doughnut chart

        if ($('#canvasDoughnut').length) {

            Chart.defaults.global.legend = {
                enabled: false
            };

            var ctx = document.getElementById("canvasDoughnut");
            var data = {
                labels: [
                "Audi",
                "BMW",
                "Daihatsu",
                "Ford",
                "Other"
                ],
                datasets: [{
                    data: [120, 50, 140, 180, 100],
                    backgroundColor: [
                    "#FF8040",
                    "#FFFF80",
                    "#FF80FF",
                    "#1FB21B",
                    "#21A4FF"
                    ],
                    hoverBackgroundColor: [
                    "#FF8040",
                    "#FFFF80",
                    "#FF80FF",
                    "#1FB21B",
                    "#21A4FF"
                    ]

                }]
            };

            var canvasDoughnut = new Chart(ctx, {
                type: 'doughnut',
                tooltipFillColor: "rgba(51, 51, 51, 0.55)",
                data: data
            });

        }

        // Radar chart

        if ($('#canvasRadar').length) {

            var ctx = document.getElementById("canvasRadar");
            var data = {
                labels: ["Sales", "Marketing", "Operations", "Logistic", "HR", "GS", "Other"],
                datasets: [{
                    label: "Number of KM's driven",
                    backgroundColor: "rgba(33, 164, 255, 0.3)",
                    borderColor: "rgba(33, 164, 255, 0.70)",
                    pointBorderColor: "rgba(33, 164, 255, 0.70)",
                    pointBackgroundColor: "rgba(33, 164, 255, 0.70)",
                    pointHoverBackgroundColor: "#fff",
                    pointHoverBorderColor: "rgba(33, 164, 255,1)",
                    pointBorderWidth: 1,
                    data: [82, 23, 66, 19, 99, 40, 62]
                }]
            };

            var canvasRadar = new Chart(ctx, {
                type: 'radar',
                data: data,
            });

        }


        // Pie chart
        if ($('#pieChart').length) {

            var ctx = document.getElementById("pieChart");
            var data = {
                labels: [
                "Sales",
                "Marketing",
                "Operations",
                "Logistic",
                "Other"
                ],
                datasets: [{
                    data: [120, 50, 140, 180, 100],
                    backgroundColor: [
                    "#FFFF00",
                    "#1FB21B",
                    "#21A4FF",
                    "#FF0000",
                    "#8080FF"
                    ],
                    hoverBackgroundColor: [
                    "#FFFF00",
                    "#1FB21B",
                    "#21A4FF",
                    "#FF0000",
                    "#8080FF"
                    ]

                }]
            };

            var pieChart = new Chart(ctx, {
                data: data,
                type: 'pie',
                otpions: {
                    legend: false
                }
            });

        }

        // PolarArea chart

        if ($('#polarArea').length) {

            var ctx = document.getElementById("polarArea");
            var data = {
                datasets: [{
                    data: [120, 50, 140, 180, 100],
                    backgroundColor: [
                    "#8080FF",
                    "#B21B1B",
                    "#FF8080",
                    "#21A4FF",
                    "#1FB21B"
                    ],
                    label: 'My dataset'
                }],
                labels: [
                    "MPV",
                    "Truck",
                    "Box",
                    "Motorcycle",
                    "Other"
                ]
            };

            var polarArea = new Chart(ctx, {
                data: data,
                type: 'polarArea',
                options: {
                    scale: {
                        ticks: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }
    }

    $(document).ready(function () {
        init_charts();
    });

    function ExportXls() {
        console.log('Submitting');
        var titleExport = '@Model.TitleExport';
        var url = '@Url.Action("ExportSummaryAllReportGenerateReport", "RptExecutiveSummary")';
        var getFileUrl = '@Url.Action("GetExcelFile", "RptExecutiveSummary")';
        console.log(url);
        var objToUpload =
			{
			    SearchViewExport: {
			        MonthFrom: $('#SearchView_MonthFrom').val(),
			        MonthTo: $('#SearchView_MonthFrom').val(),
			        YearFrom: $('#SearchView_YearFrom').val(),
			        YearTo: $('#SearchView_YearFrom').val(),
			    },
			    TitleExport: titleExport

			};
        $.ajax({
            url: url,
            data: JSON.stringify(objToUpload),
            contentType: 'application/json; charset=utf-8',
            beforeSend: function () {
                $('#LoadingModal').show();
            },
            success: function (response, status, jqxhr) {
                console.log("DONE");
                window.location = getFileUrl + "?pathFile=" + response;
                $('#LoadingModal').hide();
            },
            error: function (jqhxr) {
                console.log("ERROR");
                console.log(jqhxr.responseText);
                $('#LoadingModal').hide();
            },
            type: 'POST'
        });

    }

</script>
<link href="~/Content/DatePicker/Bootstrap Date Picker/bootstrap-datepicker.min.css" rel="stylesheet" />
<style>
    .datepicker {
        margin-left: 15px;
    }
</style>
<script src="~/Content/DatePicker/Bootstrap Date Picker/jquery-3.3.1.min.js"></script>
<script src="~/Content/DatePicker/Bootstrap Date Picker/bootstrap-datepicker.min.js"></script>